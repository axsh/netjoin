#!/usr/bin/env ruby
# -*- coding: utf-8 -*-

require 'thor'
require 'yaml'

require_relative '../lib/ducttape'
require_relative '../lib/ducttapeCLI'

module DucttapeCLI 
  
  class Main < Thor
      
    desc "instances SUBCOMMAND ...ARGS", "manage instances"
    subcommand "instances", DucttapeCLI::Instances
    
    desc "servers SUBCOMMAND ...ARGS", "manage servers"
    subcommand "servers", DucttapeCLI::Servers
    
    desc "export","Export configuration"
    def export()
      # Read config file
      config = DucttapeCLI.loadConfig()     
      puts config.inspect
    end
    
  end
  
  def self.loadConfig()
    config = YAML.load_file('config.yml')
    if(!config)
      config = {}
    end     
    return config
  end
  
  def self.writeConfig(config)
    File.open('config.yml','w') do |h| 
      h.write config.to_yaml      
    end
  end
  
end

DucttapeCLI::Main.start(ARGV)
